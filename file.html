// app.css
.app {
  font-family: Helvetica, Tahoma, Arial, Microsoft YaHei, sans-serif;
  width: 30rem;
  margin: 0 auto;
}

.container {
  position: relative;
  box-sizing: border-box;
  height: 5rem;
  box-shadow: rgba(59, 59, 177, 0.180392) 0px 0px 20px;
  background: rgb(255, 255, 255);
}

footer {
  font-size: 14px;
  color: gray;
}

footer a {
  color: #d94240;
  text-decoration: none;
}
// app.js
import React, { Component } from 'react';
import './App.css';
import List from './List';

class App extends Component {

  componentDidMount () {
    // console.log(this.state);
  }

  render() {
    // let name = this.state.data[5]['lrc_name'];
    return (
      <div className="app">
        <h2>乐集</h2>
        <h3>凡音之起，由人心生也</h3>
        <p>音乐是不假任何外力，直接沁人心脾的最纯的感情的火焰；它是从口吸入的空气，它是生命的血管中流通着的血液。</p>
        <div className="container">

        </div>
        <List />
        <footer>
          <p>
            <span>&copy; {(new Date()).getFullYear()} </span>
            <a href="www.chunqiuyiyu.com">春秋一语</a>
          </p>
        </footer>
      </div>
    );
  }
}

export default App;
// list.css
ol {
  overflow: auto;
  max-height: 500px;
  padding-left: 0;
  box-shadow: rgba(59, 59, 177, 0.180392) 0px 0px 20px;
}

ol li {
  position: relative;
  height: 32px;
  line-height: 32px;
  padding: 0 15px;
  border-bottom: 1px solid #e9e9e9;
  cursor: pointer;
  -webkit-transition: all 0.2s ease;
  transition: all 0.2s ease;
  overflow: hidden;
}

ol li:hover {
  background: #e9e9e9;
}

.is-playing {
  background: #e9e9e9;
}

li .index {
  margin-right: 12px;
  color: #666;
}

li .artist {
  float: right;
  color: #666;
}

li .current {
  display: none;
  width: 3px;
  height: 22px;
  position: absolute;
  left: 0;
  top: 5px;
  background: #d94240;
}
// list.js
import React, { Component } from 'react';
import './List.css';
import list from '../public/list.json';

class List extends Component {
  constructor() {
    super();
    this.state = {
      index: 0
    }
  }

  componentDidMount() {

  }

  setCurrent(e) {
    this.setState({
      index: e.currentTarget.children[1].innerText - 1
    });
  }

  setNext(e) {
    let index = this.state.index;
    index++;
    this.setState({
      index
    });
  }

  render() {
    return (
      <div>
        <audio src={`musics/${list.data[this.state.index].lrc_name}.mp3`} onEnded={this.setNext.bind(this)}></audio>
        <ol>
          {
            list.data.map((item, i) => {
              return (
                <li key={i}  onClick={this.setCurrent.bind(this)} className={i === this.state.index ? 'is-playing' : ''}>
                  <span className="current" style={{display: i === this.state.index ? 'block' : ''}}></span>
                  <span className="index">{i+1}</span>
                  <span className="title">{item.song_name}</span>
                  <span className="artist">{item.artist}</span>
                </li>
                )
            })
          }
        </ol>
      </div>
    );
  }
}

export default List;
